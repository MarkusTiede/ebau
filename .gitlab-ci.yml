before_script:
  - source /etc/profile
  - source /opt/xvfb.sh
  - pip install -r db_admin/requirements.txt

services:
    - wnameless/oracle-xe-11g
    - memcached

stages:
    - test


run-test:
    stage: test
    script:
        - apt-get install -y sshpass # just for testing
        - echo $LD_LIBRARY_PATH
        - hostname
        - echo $PWD
        - python .wait-for-oracle-db.py wnameless__oracle-xe-11g 1521
        - make _init
        - make ci-db-init
        - make ci-config-import
        - make ci-run-acceptance-tests

variables:
    LANG: C.UTF-8
    LC_ALL: C.UTF-8
    ORACLE_HOME: /usr/local/lib/instantclient_11_2
    LD_LIBRARY_PATH: /usr/local/lib/instantclient_11_2

