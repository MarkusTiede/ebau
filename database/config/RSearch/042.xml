<row>
  <table_name>r_search</table_name>
  <model_name>configuration.RSearch</model_name>
  <data>
    <resource_id type="int">42</resource_id>
    <result_template type="str"></result_template>
    <query type="str">SELECT  DISTINCT
  "INSTANCE"."INSTANCE_ID",
  "DOSSIERNR"."ANSWER" as "DOSSIER_NR",
  "FORM"."NAME"        as "FORM",
  "LOCATION"."NAME"    as "COMMUNITY",
  "USER"."USERNAME"        AS "USER",
  "APPLICANT_VIEW"."APPLICANT",
  (SELECT LISTAGG("NAME", ', ') WITHIN GROUP (ORDER BY "NAME") 
    FROM INTENTIONS WHERE "INSTANCE_ID" = "INSTANCE"."INSTANCE_ID") AS "INTENT",
  CASE
    WHEN "ANSWER_STREET_BG"."ANSWER" IS NOT NULL THEN "ANSWER_STREET_BG"."ANSWER"
    WHEN "ANSWER_STREET_NP"."ANSWER" IS NOT NULL THEN "ANSWER_STREET_NP"."ANSWER"
    WHEN "ANSWER_STREET_247"."ANSWER" IS NOT NULL THEN "ANSWER_STREET_247"."ANSWER"
  END AS "STREET",
  GET_INST_STATE_NAME_BY_ID("INSTANCE"."INSTANCE_STATE_ID") AS "STATE",
  "INSTANCE_STATE_DESCRIPTION"."DESCRIPTION"    AS "STATE_DESCRIPTION"
FROM "INSTANCE"
LEFT JOIN "APPLICANT_VIEW" ON (
    "INSTANCE"."INSTANCE_ID" = "APPLICANT_VIEW"."INSTANCE_ID"
)
JOIN "INSTANCE_LOCATION" ON (
    "INSTANCE"."INSTANCE_ID" = "INSTANCE_LOCATION"."INSTANCE_ID"
)
JOIN "LOCATION" ON (
    "INSTANCE_LOCATION"."LOCATION_ID" = "LOCATION"."LOCATION_ID"
)
LEFT JOIN "ANSWER"  "DOSSIERNR" ON (
    "DOSSIERNR"."INSTANCE_ID" = "INSTANCE"."INSTANCE_ID"
    AND
    "DOSSIERNR"."QUESTION_ID" = 6
    AND
    "DOSSIERNR"."CHAPTER_ID" = 2
    AND
    "DOSSIERNR"."ITEM" = 1
  )
LEFT JOIN "ANSWER" "ANSWER_INTENT" ON (
    "INSTANCE"."INSTANCE_ID" = "ANSWER_INTENT"."INSTANCE_ID"
    AND
    "ANSWER_INTENT"."QUESTION_ID" = 97
    AND
    "ANSWER_INTENT"."CHAPTER_ID" = 21
    AND
    "ANSWER_INTENT"."ITEM" = 1
  )
LEFT JOIN "ANSWER" "ANSWER_STREET_BG" ON (
    "INSTANCE"."INSTANCE_ID" = "ANSWER_STREET_BG"."INSTANCE_ID"
    AND
    "ANSWER_STREET_BG"."QUESTION_ID" = 93
    AND
    "ANSWER_STREET_BG"."CHAPTER_ID" = 21
    AND
    "ANSWER_STREET_BG"."ITEM" = 1
  )
LEFT JOIN "ANSWER" "ANSWER_STREET_NP" ON (
    "INSTANCE"."INSTANCE_ID" = "ANSWER_STREET_NP"."INSTANCE_ID"
    AND
    "ANSWER_STREET_NP"."QUESTION_ID" = 93
    AND
    "ANSWER_STREET_NP"."CHAPTER_ID" = 101
    AND
    "ANSWER_STREET_NP"."ITEM" = 1
  )
LEFT JOIN
  "ANSWER" "ANSWER_STREET_247" ON (
    "INSTANCE"."INSTANCE_ID" = "ANSWER_STREET_247"."INSTANCE_ID"
    AND
    "ANSWER_STREET_247"."QUESTION_ID" = 93
    AND
    "ANSWER_STREET_247"."CHAPTER_ID" = 102
    AND
    "ANSWER_STREET_247"."ITEM" = 1
  )
join "FORM" ON (
  "INSTANCE"."FORM_ID" = "FORM"."FORM_ID"
)
JOIN "USER" ON (
    "INSTANCE"."USER_ID" = "USER"."USER_ID"
)
LEFT JOIN "INSTANCE_STATE_DESCRIPTION" ON (
    "INSTANCE_STATE_DESCRIPTION"."INSTANCE_STATE_ID" = "INSTANCE"."INSTANCE_STATE_ID"
  )
LEFT JOIN "ANSWER"  "PARCEL_NR" ON ( 
  "INSTANCE"."INSTANCE_ID" = "PARCEL_NR"."INSTANCE_ID" AND "PARCEL_NR"."QUESTION_ID" = 91 AND "PARCEL_NR"."CHAPTER_ID" = 21 AND "PARCEL_NR"."ITEM" = 1
  )
JOIN "FORM_GROUP_FORM" ON (
  "FORM_GROUP_FORM"."FORM_ID" = "INSTANCE"."FORM_ID"
)
left JOIN "GROUP_LOCATION" ON (
     "GROUP_LOCATION"."GROUP_ID" = [GROUP_ID]
  )
LEFT JOIN "CIRCULATION" ON (
  "CIRCULATION"."INSTANCE_ID" = "INSTANCE"."INSTANCE_ID"
)

LEFT JOIN "ACTIVATION" ON (
  "ACTIVATION"."CIRCULATION_ID" = "CIRCULATION"."CIRCULATION_ID"
)
WHERE (
([ROLE_ID] = 3 AND "FORM_GROUP_FORM"."FORM_GROUP_ID" = 30)
OR
([ROLE_ID] = 1061 AND "FORM_GROUP_FORM"."FORM_GROUP_ID" = 141)
OR
([ROLE_ID] = 1101 AND "FORM_GROUP_FORM"."FORM_GROUP_ID" = 241)
OR 
([ROLE_ID] IN (7, 6) AND "GROUP_LOCATION"."LOCATION_ID" = "INSTANCE_LOCATION"."LOCATION_ID")
OR
([ROLE_ID] NOT IN (3, 1061, 6, 7, 1101)))</query>
  </data>
</row>

